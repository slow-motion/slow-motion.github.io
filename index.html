<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>skykale</title>
<link rel="shortcut icon" href="https://slow-motion.github.io/favicon.ico">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.2.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css">
<link rel="stylesheet" href="https://slow-motion.github.io/media/css/tailwind.css">
<link rel="stylesheet" href="https://slow-motion.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="skykale - Atom Feed" href="https://slow-motion.github.io/atom.xml">

    

  <meta name="description" content="éšä¾¿å†™å†™" />
</head>
<body>
  <div class="antialiased flex flex-col min-h-screen" id="app">

    <div class="nav py-3 md:py-8 fixed w-full z-10 bg-gray-50 dark:bg-gray-700 transition-all duration-300" :class="{ 'scroll': scrolled }">
  <div class="flex justify-end px-4">
    <div class="w-8 h-8 flex justify-center items-center rounded-full md:hidden" @click="showMenu = !showMenu">
      <i class="ri-close-line" v-show="showMenu"></i>
      <i class="ri-menu-3-line" v-show="!showMenu"></i>
    </div>
  </div>
  <nav class="max-w-4xl w-full mx-auto text-center flex flex-col md:flex-row justify-center md:block" :class="`${ showMenu ? 'block' : 'hidden' }`">
    
      <a href="/" target="" class="py-2 md:py-1 px-4 mx-4 inline-flex transition font-semibold rounded dark:hover:bg-gray-600 hover:bg-gray-200">
        é¦–é¡µ
      </a>
    
      <a href="/archives" target="" class="py-2 md:py-1 px-4 mx-4 inline-flex transition font-semibold rounded dark:hover:bg-gray-600 hover:bg-gray-200">
        å½’æ¡£
      </a>
    
      <a href="/tags" target="" class="py-2 md:py-1 px-4 mx-4 inline-flex transition font-semibold rounded dark:hover:bg-gray-600 hover:bg-gray-200">
        æ ‡ç­¾
      </a>
    
      <a href="/post/about" target="" class="py-2 md:py-1 px-4 mx-4 inline-flex transition font-semibold rounded dark:hover:bg-gray-600 hover:bg-gray-200">
        å…³äº
      </a>
    
    <a href="https://slow-motion.github.io/atom.xml" target="_blank" class="py-2 md:py-1 px-4 mx-4 inline-flex transition font-semibold rounded dark:hover:bg-gray-600 hover:bg-gray-200">
      RSS
    </a>
  </nav>
</div>

    <div class="max-w-4xl w-full mx-auto ">
      
        <header class="flex py-16 md:py-32 mt-12 flex-col md:flex-row px-4 md:px-0 animated fadeIn">
  <div class="flex-1 order-2 md:order-1 md:pr-16">
    <div class="text-4xl font-bold text-center md:text-left">
      skykale
    </div>
    <div class="text-xl text-gray-500 mt-4 text-center md:text-left">
      éšä¾¿å†™å†™
    </div>
    
      <div class="mt-8 text-center md:text-left">
        <a
          href="/post/about" 
          arget="_blank"
          class="text-sm bg-yellow-50 dark:bg-indigo-500 dark:text-gray-700 font-semibold px-4 py-2 inline-block yellow-btn transition-fast rounded"
        >LET&#39;S TALK!</a>
      </div>
    
    
      <div class="mt-8 flex items-center">
        
          <div class="text-gray-500 mr-2">
            Follow me ğŸ‘‰
          </div>
        
        
          
        
          
            
              <a href="kluo0401@outlook.com" target="_blank" class="mr-2 w-8 h-8 inline-flex items-center justify-center text-xl hover:bg-gray-200 dark:hover:bg-gray-600 transition-fast">
                <i class="ri-mail-line"></i>
              </a>
            
          
        
          
            
              <a href="https://github.com/slow-motion" target="_blank" class="mr-2 w-8 h-8 inline-flex items-center justify-center text-xl hover:bg-gray-200 dark:hover:bg-gray-600 transition-fast">
                <i class="ri-github-line"></i>
              </a>
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    
  </div>
  <div class="md:mx-8 flex-shrink-0 self-start rounded-full border-4 border-dotted border-transparent hover:border-yellow-50 p-2 w-32 h-32 order-1 md:order-2 mx-auto s3-dotted">
    <img class="rounded-full object-cover" src="https://slow-motion.github.io/images/avatar.png?v=1623746813178" alt="skykale" width="100%" height="100%">
  </div>
</header>
      

      <div class="shadow-box bg-white dark:bg-gray-600 border-gray-300 rounded-none md:rounded-lg -mx-1 md:mx-0 md:px-0">
        
  <div class="p-8 border-b border-gray-200 dark:border-gray-700 flex relative overflow-hidden flex-col md:flex-row animated fadeIn">
    
    <div class="flex-1 order-2 md:order-1">
      <h2 class="text-2xl font-semibold mb-4">
        <a href="https://slow-motion.github.io/post/ruan-jian-she-ji-shuo-ming/" class="text-gray-700 dark:text-gray-200 border-b-2 border-dotted border-gray-200 dark:border-gray-400 dark:hover:border-gray-200 hover:border-gray-600 transition-all duration-100">
          VGG ç½‘ç»œåˆ©ç”¨è¿ç§»å­¦ä¹ å¤ç°
        </a>
      </h2>
      <div class="mb-4 text-xs text-gray-500">2021-06-15</div>
      <div class="mb-4 text-gray-500 dark:text-gray-300">
        <h2 id="1-ç®€ä»‹">1. ç®€ä»‹</h2>
<p>â€‹	è™½ç„¶ AlexNet è¯æ˜æ·±å±‚ç¥ç»ç½‘ç»œå“æœ‰æˆæ•ˆï¼Œä½†å®ƒæ²¡æœ‰æä¾›ä¸€ä¸ªé€šç”¨çš„æ¨¡æ¿æ¥æŒ‡å¯¼åç»­çš„ç ”ç©¶äººå‘˜è®¾è®¡æ–°çš„ç½‘ç»œã€‚ åœ¨ä¸‹é¢çš„å‡ ä¸ªç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€äº›å¸¸ç”¨äºè®¾è®¡æ·±å±‚ç¥ç»ç½‘ç»œçš„å¯å‘å¼æ¦‚å¿µã€‚</p>
<p>â€‹	ä¸èŠ¯ç‰‡è®¾è®¡ä¸­å·¥ç¨‹å¸ˆä»æ”¾ç½®æ™¶ä½“ç®¡åˆ°é€»è¾‘å…ƒä»¶å†åˆ°é€»è¾‘å—çš„è¿‡ç¨‹ç±»ä¼¼ï¼Œç¥ç»ç½‘ç»œç»“æ„çš„è®¾è®¡ä¹Ÿé€æ¸å˜å¾—æ›´åŠ æŠ½è±¡ã€‚ç ”ç©¶äººå‘˜å¼€å§‹ä»å•ä¸ªç¥ç»å…ƒçš„è§’åº¦æ€è€ƒé—®é¢˜ï¼Œå‘å±•åˆ°æ•´ä¸ªå±‚æ¬¡ï¼Œç°åœ¨åˆè½¬å‘æ¨¡å—ï¼Œé‡å¤å„å±‚çš„æ¨¡å¼ã€‚</p>
<p>â€‹	ä½¿ç”¨å—çš„æƒ³æ³•é¦–å…ˆå‡ºç°åœ¨ç‰›æ´¥å¤§å­¦çš„ <a href="http://www.robots.ox.ac.uk/~vgg/">è§†è§‰å‡ ä½•ç»„ï¼ˆvisualgeometry Groupï¼‰</a> (VGG) çš„ VGG ç½‘ç»œä¸­ã€‚é€šè¿‡ä½¿ç”¨å¾ªç¯å’Œå­ç¨‹åºï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨ä»»ä½•ç°ä»£æ·±åº¦å­¦ä¹ æ¡†æ¶çš„ä»£ç ä¸­å®ç°è¿™äº›é‡å¤çš„ç»“æ„ã€‚</p>
<ul>
<li>
<p>VGGå—</p>
<p>â€‹	ç»å…¸å·ç§¯ç¥ç»ç½‘ç»œçš„åŸºæœ¬ç»„æˆéƒ¨åˆ†æ˜¯ä¸‹é¢çš„è¿™ä¸ªåºåˆ—ï¼š 1. å¸¦å¡«å……ä»¥ä¿æŒåˆ†è¾¨ç‡çš„å·ç§¯å±‚ï¼› 1. éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œå¦‚ReLUï¼› 1. æ± åŒ–å±‚ï¼Œå¦‚æœ€å¤§æ± åŒ–å±‚ã€‚è€Œä¸€ä¸ª VGG å—ä¸ä¹‹ç±»ä¼¼ï¼Œç”±ä¸€ç³»åˆ—å·ç§¯å±‚ç»„æˆï¼Œåé¢å†åŠ ä¸Šç”¨äºç©ºé—´ä¸‹é‡‡æ ·çš„æœ€å¤§æ± åŒ–å±‚ã€‚åœ¨æœ€åˆçš„ VGG è®ºæ–‡ [<a href="https://zh-v2.d2l.ai/chapter_references/zreferences.html#simonyan-zisserman-2014">Simonyan &amp; Zisserman, 2014]</a> ä¸­ï¼Œä½œè€…ä½¿ç”¨äº†å¸¦æœ‰ 3Ã—3 å·ç§¯æ ¸ã€å¡«å……ä¸º 1ï¼ˆä¿æŒé«˜åº¦å’Œå®½åº¦ï¼‰çš„å·ç§¯å±‚ï¼Œå’Œå¸¦æœ‰ 2Ã—2 æ± åŒ–çª—å£ã€æ­¥å¹…ä¸º 2ï¼ˆæ¯ä¸ªå—åçš„åˆ†è¾¨ç‡å‡åŠï¼‰çš„æœ€å¤§æ± åŒ–å±‚ã€‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>vgg_block</code> çš„å‡½æ•°æ¥å®ç°ä¸€ä¸ª VGG å—ã€‚</p>
</li>
<li>
<p>VGGç½‘ç»œæ¨¡å‹</p>
<p>â€‹	ä¸ AlexNetã€LeNet ä¸€æ ·ï¼ŒVGG ç½‘ç»œå¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šç¬¬ä¸€éƒ¨åˆ†ä¸»è¦ç”±å·ç§¯å±‚å’Œæ± åŒ–å±‚ç»„æˆï¼Œç¬¬äºŒéƒ¨åˆ†ç”±å…¨è¿æ¥å±‚ç»„æˆã€‚å¦‚ä¸‹å›¾æ‰€ç¤º</p>
<figure data-type="image" tabindex="1"><a href="https://imgtu.com/i/2H0JVf"><img src="https://z3.ax1x.com/2021/06/15/2H0JVf.png" alt="2H0JVf.png" loading="lazy"></a></figure>
</li>
</ul>
<p>â€‹	åŸå§‹ VGG ç½‘ç»œæœ‰ 5 ä¸ªå·ç§¯å—ï¼Œå…¶ä¸­å‰ä¸¤ä¸ªå—å„æœ‰ä¸€ä¸ªå·ç§¯å±‚ï¼Œåä¸‰ä¸ªå—å„åŒ…å«ä¸¤ä¸ªå·ç§¯å±‚ã€‚ ç¬¬	ä¸€ä¸ªæ¨¡å—æœ‰ 64 ä¸ªè¾“å‡ºé€šé“ï¼Œæ¯ä¸ªåç»­æ¨¡å—å°†è¾“å‡ºé€šé“æ•°é‡ç¿»å€ï¼Œç›´åˆ°è¯¥æ•°å­—è¾¾åˆ° 512ã€‚ç”±äºè¯¥ç½‘	ç»œä½¿ç”¨ 8 ä¸ªå·ç§¯å±‚å’Œ 3 ä¸ªå…¨è¿æ¥å±‚ï¼Œå› æ­¤å®ƒé€šå¸¸è¢«ç§°ä¸º VGG-11ã€‚</p>
<p>â€‹	æ€»ç»“å¦‚ä¸‹ï¼š</p>
<ol>
<li>VGG-11 ä½¿ç”¨å¯å¤ç”¨çš„å·ç§¯å—æ„é€ ç½‘ç»œã€‚ä¸åŒçš„ VGG æ¨¡å‹å¯é€šè¿‡æ¯ä¸ªå—ä¸­å·ç§¯å±‚æ•°é‡å’Œè¾“å‡ºé€šé“æ•°é‡çš„å·®å¼‚æ¥å®šä¹‰ã€‚</li>
<li>å—çš„ä½¿ç”¨å¯¼è‡´ç½‘ç»œå®šä¹‰çš„éå¸¸ç®€æ´ã€‚ä½¿ç”¨å—å¯ä»¥æœ‰æ•ˆåœ°è®¾è®¡å¤æ‚çš„ç½‘ç»œã€‚</li>
<li>åœ¨VGGè®ºæ–‡ä¸­ï¼ŒSimonyanå’ŒZisermanå°è¯•äº†å„ç§æ¶æ„ã€‚ç‰¹åˆ«æ˜¯ä»–ä»¬å‘ç°æ·±å±‚ä¸”çª„çš„å·ç§¯ï¼ˆå³3Ã—3ï¼‰æ¯”è¾ƒæµ…å±‚ä¸”å®½çš„å·ç§¯æ›´æœ‰æ•ˆã€‚</li>
</ol>
<h2 id="2-æ„Ÿå—é‡">2. æ„Ÿå—é‡</h2>
<p>â€‹	è¿™é‡Œä¼šæ¶‰åŠä¸€ä¸ªåä¸ºæ„Ÿå—é‡ï¼ˆReceptive Fieldï¼‰çš„æ¦‚å¿µï¼Œå®ƒæŒ‡çš„æ˜¯å·ç§¯ç¥ç»ç½‘ç»œæ¯ä¸€å±‚è¾“å‡ºçš„ç‰¹å¾å›¾ï¼ˆfeature  mapï¼‰ä¸Šçš„åƒç´ ç‚¹åœ¨è¾“å…¥å›¾ç‰‡ä¸Šæ˜ å°„çš„åŒºåŸŸå¤§å°ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯ç‰¹å¾å›¾ä¸Šçš„ä¸€ç‚¹è·ŸåŸæœ‰å›¾ä¸Šæœ‰å…³ç³»çš„ç‚¹çš„åŒºåŸŸã€‚ä¸€èˆ¬å–ä¸€ä¸ªpixelä¸ºå•ä½ï¼Œè€Œè¾“å…¥çš„æ„Ÿå—é‡å°±æ˜¯1å³åªå¯¹åº”å…¶è‡ªèº«çš„é‚£ä¸ªåƒç´ ã€‚ç”»å›¾æ˜“çŸ¥ï¼Œä¸¤å±‚3x3çš„å·ç§¯å±‚æ‰€å¾—åˆ°çš„æ„Ÿå—é‡ä¸ä¸€å±‚5x5çš„å·ç§¯å±‚çš„æ„Ÿå—é‡ç›¸åŒï¼Œè¿™ä¹Ÿæ˜¯VGGä½¿ç”¨3x3å°å·ç§¯æ ¸æ¥ä»£æ›¿çš„åŸç†ä¹‹ä¸€ã€‚</p>
<h2 id="3-11-å·ç§¯æ ¸">3. 1*1 å·ç§¯æ ¸</h2>
<p>â€‹	è™½ç„¶VGGæ‰€ç”¨çš„æ˜¯2x2çš„å·ç§¯æ ¸ï¼Œä½†æ˜¯åœ¨ä¸Šæ–‡æåˆ°äº†ä¸€äº›ç½‘ç»œä½¿ç”¨1x1çš„å…¨å·ç§¯å±‚ä»£æ›¿å…¨è¿æ¥å±‚ï¼Œé‚£ä¹ˆé¡ºä¾¿å°±å¯¹1x1å·ç§¯æ ¸çš„ä½œç”¨åšä¸€ä¸ªæ€»ç»“ã€‚</p>
<ol>
<li>å¦‚ä¸Šæ–‡æ‰€è¿°ï¼Œä½¿ç”¨å·ç§¯å±‚å°±æ²¡æœ‰å…¨è¿æ¥å±‚å¯¹è¾“å…¥å°ºå¯¸çš„é™åˆ¶ï¼Œè¿™ä¹Ÿæ–¹ä¾¿äº†è®¸å¤šã€‚</li>
<li>å…¨è¿æ¥å±‚ä¼šæ”¹å˜ç½‘ç»œçš„ç©ºé—´ç»“æ„ï¼Œå·ç§¯å±‚ä¸ä¼šç ´åå›¾åƒçš„ç©ºé—´ç»“æ„ã€‚ä¸€èˆ¬è¦å­¦ä¹ æ˜¯ç›¸é‚»çš„è¾¹ç•Œç­‰ç‰¹å¾ï¼Œè€Œå…¨è¿æ¥æ¯«æ— ç›®çš„åœ°å°†æ•´å¼ å›¾â€œå…¨è¿æ¥â€ï¼Œæ¢è¨€ä¹‹å…¨è¿æ¥è¾“å‡ºçš„æ˜¯ä¸€ç»´å‘é‡ï¼ŒåŠ¿å¿…å°†ä¸¢å¤±å¤§é‡äºŒç»´ä¿¡æ¯ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸åˆé€‚çš„ã€‚</li>
<li>å¯ä»¥ç”¨äºä¸ºå†³ç­–å¢åŠ éçº¿æ€§å› ç´ ã€‚</li>
<li>ä¸€äº›æ¨¡å‹ç”¨1x1çš„å…¨è¿æ¥å±‚æ¥è°ƒæ•´ç½‘ç»œç»´åº¦ã€‚æ¯”å¦‚ MobileNet ä½¿ç”¨ 1x1 çš„å·ç§¯æ ¸æ¥æ‰©ç»´ï¼ŒGoogleNetã€ResNet ä½¿ç”¨1x1çš„å·ç§¯æ ¸æ¥é™ç»´ã€‚è¿™é‡Œçš„é™ç»´ç±»ä¼¼äºå‹ç¼©å¤„ç†ï¼Œå¹¶ä¸ä¼šå½±å“è®­ç»ƒç»“æœï¼Œè€Œ1x1çš„å·ç§¯æ ¸å¯ä»¥ä½¿ç½‘ç»œå˜è–„ï¼Œå¯ä»¥æˆå€åœ°å‡å°‘è®¡ç®—é‡ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨ naive çš„ inception ï¼Œé‚£ä¹ˆæœ€å concatenate å‡ºæ¥çš„ç‰¹å¾å›¾åšåº¦ä¼šå¾ˆå¤§ï¼Œè€Œæ·»åŠ ä¸Š 1x1 çš„å·ç§¯æ ¸ä¹‹åå°±å¯ä»¥è°ƒæ•´åšåº¦äº†ã€‚</li>
</ol>
<h2 id="4-å®˜æ–¹æºç ">4. å®˜æ–¹æºç </h2>
<pre><code class="language-python">import torch.nn as nn
import math

class VGG(nn.Module):

    def __init__(self, features, num_classes=1000, init_weights=True):
        super(VGG, self).__init__()
        self.features = features
        self.classifier = nn.Sequential(
            nn.Linear(512 * 7 * 7, 4096),
            nn.ReLU(True),
            nn.Dropout(),
            nn.Linear(4096, 4096),
            nn.ReLU(True),
            nn.Dropout(),
            nn.Linear(4096, num_classes),
        )
        if init_weights:
            self._initialize_weights()

    def forward(self, x):
        x = self.features(x)
        x = x.view(x.size(0), -1)
        x = self.classifier(x)
        return x

    def _initialize_weights(self):
        for m in self.modules():
            if isinstance(m, nn.Conv2d):
                n = m.kernel_size[0] * m.kernel_size[1] * m.out_channels
                m.weight.data.normal_(0, math.sqrt(2. / n))
                if m.bias is not None:
                    m.bias.data.zero_()
            elif isinstance(m, nn.BatchNorm2d):
                m.weight.data.fill_(1)
                m.bias.data.zero_()
            elif isinstance(m, nn.Linear):
                m.weight.data.normal_(0, 0.01)
                m.bias.data.zero_()
</code></pre>
<p>â€‹	å› ä¸ºVGGä¸­å·ç§¯å±‚çš„é‡å¤æ€§æ¯”è¾ƒé«˜ï¼Œæ‰€ä»¥å®˜æ–¹ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ¥å¾ªç¯äº§ç”Ÿå·ç§¯å±‚ï¼š</p>
<pre><code class="language-python">def make_layers(cfg, batch_norm=False):
    layers = []
    in_channels = 3
    for v in cfg:
        if v == 'M':
            layers += [nn.MaxPool2d(kernel_size=2, stride=2)]
        else:
            conv2d = nn.Conv2d(in_channels, v, kernel_size=3, padding=1)
            if batch_norm:
                layers += [conv2d, nn.BatchNorm2d(v), nn.ReLU(inplace=True)]
            else:
                layers += [conv2d, nn.ReLU(inplace=True)]
            in_channels = v
    return nn.Sequential(*layers)
</code></pre>
<p>â€‹	æ¥ä¸‹æ¥å®šä¹‰å„ä¸ªç‰ˆæœ¬çš„å·ç§¯å±‚ï¼Œè¿™é‡Œçš„â€œMâ€è¡¨ç¤ºçš„æ˜¯æœ€å¤§æ± åŒ–å±‚ã€‚</p>
<pre><code class="language-python">cfg = {
    'A': [64, 'M', 128, 'M', 256, 256, 'M', 512, 512, 'M', 512, 512, 'M'],
    'B': [64, 64, 'M', 128, 128, 'M', 256, 256, 'M', 512, 512, 'M', 512, 512, 'M'],
    'D': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 512, 512, 512, 'M', 512, 512, 512, 'M'],
    'E': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 256, 'M', 512, 512, 512, 512, 'M', 512, 512, 512, 512, 'M'],
}

def vgg11(**kwargs):
    model = VGG(make_layers(cfg['A']), **kwargs)
    return model

def vgg11_bn(**kwargs):
    model = VGG(make_layers(cfg['A'], batch_norm=True), **kwargs)
    return model

def vgg13(**kwargs):
    model = VGG(make_layers(cfg['B']), **kwargs)
    return model

def vgg13_bn(**kwargs):
    model = VGG(make_layers(cfg['B'], batch_norm=True), **kwargs)
    return model

def vgg16(**kwargs):
    model = VGG(make_layers(cfg['D']), **kwargs)
    return model

def vgg16_bn(**kwargs):
    model = VGG(make_layers(cfg['D'], batch_norm=True), **kwargs)
    return model

def vgg19(**kwargs):
    model = VGG(make_layers(cfg['E']), **kwargs)
    return model

def vgg19_bn(**kwargs):
    model = VGG(make_layers(cfg['E'], batch_norm=True), **kwargs)
    return model

if __name__ == '__main__':
    # 'VGG', 'vgg11', 'vgg11_bn', 'vgg13', 'vgg13_bn', 'vgg16', 'vgg16_bn', 'vgg19_bn', 'vgg19'
    # Example
    net11 = vgg11()
    print(net11)
</code></pre>
<h2 id="5-è®¾è®¡æ€è·¯">5. è®¾è®¡æ€è·¯</h2>
<p>â€‹	é€šå¸¸åœ¨ä¸€äº›ç°å®ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬æ‰€èƒ½æ‹¿åˆ°çš„æ•°æ®æ¯”è¾ƒå°‘ï¼Œè€Œæ·±åº¦å­¦ä¹ æ¨¡å‹çš„å‚æ•°æ›´æ–°é€šå¸¸éœ€è¦å¤§é‡çš„æ•°æ®æ¥é©±åŠ¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥å¯¹æŸäº›å±‚ç”¨åˆ°é¢„è®­ç»ƒæ¨¡å‹ã€‚å¯¹ VGG19 çš„é¢„è®­ç»ƒæ¨¡å‹ä½¿ç”¨éƒ¨åˆ†å‚æ•°ï¼ŒæŒ‰ç…§æºç è®¾ç½®å“åº”å‚æ•°ï¼š</p>
<p>â€‹</p>
<pre><code class="language-python">		self.features = features
        self.avgpool = nn.AdaptiveAvgPool2d((7, 7))
        self.classifier = nn.Sequential(
            nn.Linear(512 * 7 * 7, 4096),
            nn.ReLU(True),
            nn.Dropout(),
            nn.Linear(4096, 4096),
            nn.ReLU(True),
            nn.Dropout(),
            nn.Linear(4096, num_classes),  # num_classes=1000
        )

</code></pre>
<p>â€‹	å®˜æ–¹æ¨¡å‹ä¸­ï¼Œä¸»è¦åŒ…æ‹¬featuresï¼Œavgpoolï¼Œè¿˜æœ‰classifierå‡ ä¸ªæ¨¡å—ã€‚featureså°±æ˜¯å·ç§¯æ¨¡å—ç”¨æ¥æå–ç‰¹å¾ï¼Œavgpoolæ˜¯è‡ªé€‚åº”çš„å¹³å‡æ± åŒ–å±‚ï¼Œclassifieræ˜¯åŒ…å«å…¨è¿æ¥å±‚çš„åˆ†ç±»å™¨ã€‚æ¯”å¦‚æˆ‘ç°åœ¨åªéœ€è¦å¯¹80ä¸ªç±»å»ºç«‹åˆ†ç±»æ¨¡å‹ï¼Œé‚£ä¹ˆæˆ‘é™¤äº†æœ€åä¸€ä¸ªLinearçš„å‚æ•°,å…¶ä»–éƒ½éœ€è¦ç”¨åˆ°é¢„è®­ç»ƒæ¨¡å‹å‚æ•°ã€‚</p>
<p>â€‹	é‚£ä¹ˆæˆ‘çš„æ¨¡å‹è®¾ç½®ï¼š</p>
<pre><code class="language-python">		self.features = nn.Sequential(
            # Layer 1
            nn.Conv2d(3, 64, 3, padding=1),
            nn.ReLU(inplace=True),
            nn.Conv2d(64, 64, 3, padding=1),
            nn.ReLU(inplace=True),
            nn.MaxPool2d(2, stride=2),
            # Layer 2
            nn.Conv2d(64, 128, 3, padding=1),
            nn.ReLU(inplace=True),
            nn.Conv2d(128, 128, 3, padding=1),
            nn.ReLU(inplace=True),
            nn.MaxPool2d(2, stride=2),
            # Layer 3
            nn.Conv2d(128, 256, 3, padding=1),
            nn.ReLU(inplace=True),
            nn.Conv2d(256, 256, 3, padding=1),
            nn.ReLU(inplace=True),
            nn.Conv2d(256, 256, 3, padding=1),
            nn.ReLU(inplace=True),
            nn.Conv2d(256, 256, 3, padding=1),
            nn.ReLU(inplace=True),
            nn.MaxPool2d(2, stride=2),
            # Layer 4
            nn.Conv2d(256, 512, 3, padding=1),
            nn.ReLU(inplace=True),
            nn.Conv2d(512, 512, 3, padding=1),
            nn.ReLU(inplace=True),
            nn.Conv2d(512, 512, 3, padding=1),
            nn.ReLU(inplace=True),
            nn.Conv2d(512, 512, 3, padding=1),
            nn.ReLU(inplace=True),
            nn.MaxPool2d(2, stride=2),
            # Layer 5
            nn.Conv2d(512, 512, 3, padding=1),
            nn.ReLU(inplace=True),
            nn.Conv2d(512, 512, 3, padding=1),
            nn.ReLU(inplace=True),
            nn.Conv2d(512, 512, 3, padding=1),
            nn.ReLU(inplace=True),
            nn.Conv2d(512, 512, 3, padding=1),
            nn.ReLU(inplace=True),
            nn.MaxPool2d(2, stride=2)
        )
        self.avgpool = nn.AdaptiveAvgPool2d((7, 7))
        self.classifier = nn.Sequential(
            nn.Linear(512*7*7, 4096),
            nn.ReLU(inplace=True),
            nn.Dropout(),
            nn.Linear(4096, 4096),
            nn.ReLU(inplace=True),
            nn.Dropout(),
        )
        # å•ç‹¬æŠŠæœ€åä¸€å±‚æå–å‡ºæ¥
        self.classifier2 = nn.Linear(4096, num_classes)

</code></pre>

      </div>
      <a href="https://slow-motion.github.io/post/ruan-jian-she-ji-shuo-ming/" class="btn">
        Read more
      </a>
    </div>
    
  </div>

  <div class="p-8 border-b border-gray-200 dark:border-gray-700 flex relative overflow-hidden flex-col md:flex-row animated fadeIn">
    
    <div class="flex-1 order-2 md:order-1">
      <h2 class="text-2xl font-semibold mb-4">
        <a href="https://slow-motion.github.io/post/ruan-jian-gong-cheng-da-zuo-ye/" class="text-gray-700 dark:text-gray-200 border-b-2 border-dotted border-gray-200 dark:border-gray-400 dark:hover:border-gray-200 hover:border-gray-600 transition-all duration-100">
          è½¯ä»¶å·¥ç¨‹å¤§ä½œä¸š
        </a>
      </h2>
      <div class="mb-4 text-xs text-gray-500">2021-06-15</div>
      <div class="mb-4 text-gray-500 dark:text-gray-300">
        Introduce
â€‹	è™½ç„¶ AlexNet è¯æ˜æ·±å±‚ç¥ç»ç½‘ç»œå“æœ‰æˆæ•ˆï¼Œä½†å®ƒæ²¡æœ‰æä¾›ä¸€ä¸ªé€šç”¨çš„æ¨¡æ¿æ¥æŒ‡å¯¼åç»­çš„ç ”ç©¶äººå‘˜è®¾è®¡æ–°çš„ç½‘ç»œã€‚ åœ¨ä¸‹é¢çš„å‡ ä¸ªç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€äº›å¸¸ç”¨äºè®¾è®¡æ·±å±‚ç¥ç»ç½‘ç»œçš„å¯å‘å¼æ¦‚å¿µã€‚
â€‹	ä¸èŠ¯ç‰‡è®¾è®¡ä¸­å·¥ç¨‹å¸ˆä»æ”¾ç½®æ™¶ä½“ç®¡...
      </div>
      <a href="https://slow-motion.github.io/post/ruan-jian-gong-cheng-da-zuo-ye/" class="btn">
        Read more
      </a>
    </div>
    
  </div>
  
      </div>

      
      <footer class="py-12 text-center px-4 md:px-0" v-pre>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
</footer>

    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script src="https://slow-motion.github.io/media/scripts/main.js"></script>
</body>

</html>